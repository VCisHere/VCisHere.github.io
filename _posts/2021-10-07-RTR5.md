---
layout: post
title: "Real-Time Rendering 第五章 着色基础（Shading Basics）"
date: 2021-10-07 22:00:21 +0800
category: "计算机 图形学"
typora-root-url: ..
---

# Real-Time Rendering 

## 第五章 着色基础

渲染三维对象的图像时，模型不仅应具有适当的几何形状，还应具有所需的视觉外观。根据不同的需求，模型的视觉外观可以是真实感外观（外观接近真实物体）或是各种风格化外观。如下图所示，上面的图片是一种真实感外观渲染，下面的图片是一种风格化外观渲染。

![](/assets/img/5-1.png)

本章将讨论照片级真实感渲染和风格化渲染的着色基础。

### 着色模型（Shading Models）

确认渲染对象外观的第一步是选额着色模型。着色模型用于描述对象应该如何根据对象表面法线、视角方向（view direction）和光照方向等因素来计算其外观（颜色）。

![](/assets/img/5-2.png)

举个例子，我们将使用Gooch着色模型的变体。这是非真实感渲染的一种形式。

Gooch着色基本思想是将表面法线与光源的位置进行比较。如果法线指向灯光，则使用较暖的色调为表面着色，否则使用较冷的色调。介于两者之间的角度在这些色调之间进行插值，这取决于用户提供的表面颜色。如下图所示：

![](/assets/img/5-3.png)

着色模型通常具有用于控制外观变化的属性（properties）。设置这些属性的值是确定对象外观的下一步。我们的示例模型只有一种属性，即表面颜色。

我们可以看一下模型本身的数学定义：

$$\bf{c}_{shaded}=s\bf{c}_{highlight}+(1-s)(t\bf{c}_{warm}+(1-t)\bf{c}_{cool})$$

其中：

$$\bf{c}_{cool}=(0,0,0.55)+0.25\bf{c}_{surface}$$，

$$\bf{c}_{warm}=(0.3,0.3,0)+0.25\bf{c}_{surface}$$，

$$\bf{c}_{highlight}=(1,1,1)$$，

$$t=\frac{(n\cdot l)+1}{2}$$，

$$\bf{r}=2(\bf{n}\cdot\bf{l})\bf{n}-\bf{l}$$，

$$s=(100(\bf{r}\cdot\bf{v})-97)^{\mp}$$。

该定义中的几个数学表达式也经常可以在其他着色模型中找到。着色操作中通常会进行Clamping操作，通常Clamping到0或Clamping在0到1之间。这里的标记是将高光混合因子$$s$$Clamping在0到1之间。点积运算符出现3次，每次出现在两个单位长度的向量之间，这是一个非常常见的模式。两个向量的点积是它们的长度与它们之间夹角的余弦的乘积。因此，两个单位长度向量的点积就是余弦，它是两个向量彼此对齐程度的度量。由余弦组成的简单函数通常是最令人愉悦和最准确的数学表达式，用于说明着色模型中两个方向（例如，光照方向和表面法线）之间的关系。

另一种常见的着色操作是基于0到1之间的标量值在两种颜色之间线性插值。该操作采用$$t\bf{c}_a+(1-t)\bf{c}_b$$的形式，随着$$t$$的值在1和0之间移动，它会在$$\bf{c}_a$$和$$\bf{c}_b$$之间进行插值。此形式在上面的模型中出现了两次，一次是在$$\bf{c}_{warm}$$和$$\bf{c}_{cool}$$之间插值，第二次在前面的插值结果与$$\bf{c}_{highlight}$$之间进行插值。线性插值在着色器中出现的频率很高，以至于在大多数着色语言中，它都是一个内置函数，称为lerp或mix。

向量$$\bf{r}=2(\bf{n}\cdot\bf{l})\bf{n}-\bf{l}$$是反射光向量，是光线$$\bf{l}$$关于法线$$\bf{n}$$的反射光线。尽管不像前两个操作那样常见，但是大多数着色语言也都具有内置的反射（reflect）功能。

通过将这些操作以不同的方式与各种数学表达式和着色参数组合在一起，可以为多种风格化和写实的外观定义着色模型。

### 光源（Light Sources）











